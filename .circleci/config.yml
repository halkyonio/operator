# Golang CircleCI 2.0 configuration file
#
# Check https://circleci.com/docs/2.0/language-go/ for more details
version: 2.1

commands:
  install:
    steps:
      - run:
          name: Install kubectl
          command: |
            KUBE_VERSION=v1.13.0
            curl -LO https://storage.googleapis.com/kubernetes-release/release/${KUBE_VERSION}/bin/linux/amd64/kubectl
            chmod +x ./kubectl && sudo mv ./kubectl /usr/local/bin/kubectl
      - persist_to_workspace:
          root: /usr/local/bin
          paths:
            - kubectl
  use:
    steps:
      - attach_workspace:
          at: /usr/local/bin/kubectl
      - run:
          name: Print kubectl version
          command: kubectl version

jobs:
  first-job:
    machine: true
    steps:
    - install
  second-job:
    machine: true
    steps:
    - use

workflows:
  version: 2
  dummy:
    jobs:
      - first-job
      - second-job:
          requires:
            - first-job
